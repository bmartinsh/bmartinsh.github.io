<!DOCTYPE html>
<html style="font-size: 16px;"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <meta name="keywords" content="Bedtime Stories AI, Claude AI, Kids Stories, AI Storyteller, Children Stories">
    <meta name="description" content="Generate magical bedtime stories for kids powered by Claude AI">
    <title>Bedtime Stories AI üåô</title>
    <link rel="icon" type="image/x-icon" href="images/c267f3ce97e6dd79975da8d5128630d3fe89635fafdcb1d683e63faf6b4c71ee632313c7288461520d2559f298e089f5e0d25aa91c8704506e1bbd_1280.png">
    <link rel="stylesheet" href="css/Home.css" media="screen">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <meta property="og:title" content="Bedtime Stories AI">
    <meta property="og:description" content="Generate magical bedtime stories for kids powered by Claude AI">
    <meta property="og:image" content="images/c267f3ce97e6dd79975da8d5128630d3fe89635fafdcb1d683e63faf6b4c71ee632313c7288461520d2559f298e089f5e0d25aa91c8704506e1bbd_1280.png">
    <meta property="og:url" content="bts-ai.com">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#0d1b3e">
</head>
<body>
    <!-- Stars Background -->
    <div class="stars-bg" aria-hidden="true">
        <span class="star" style="top:4%;  left:8%;  animation-delay:0s;">‚ú¶</span>
        <span class="star" style="top:11%; left:78%; animation-delay:0.5s;">‚úß</span>
        <span class="star" style="top:20%; left:33%; animation-delay:1s;">‚ú¶</span>
        <span class="star" style="top:7%;  left:54%; animation-delay:1.4s;">‚úß</span>
        <span class="star" style="top:33%; left:91%; animation-delay:0.8s;">‚ú¶</span>
        <span class="star" style="top:62%; left:12%; animation-delay:2s;">‚úß</span>
        <span class="star" style="top:70%; left:63%; animation-delay:0.3s;">‚ú¶</span>
        <span class="star" style="top:83%; left:43%; animation-delay:1.7s;">‚úß</span>
        <span class="star" style="top:47%; left:4%;  animation-delay:0.6s;">‚ú¶</span>
        <span class="star" style="top:16%; left:94%; animation-delay:1.2s;">‚úß</span>
        <span class="star" style="top:54%; left:82%; animation-delay:2.2s;">‚ú¶</span>
        <span class="star" style="top:91%; left:72%; animation-delay:0.9s;">‚úß</span>
        <span class="star" style="top:38%; left:58%; animation-delay:1.6s;">‚ú¶</span>
        <span class="star" style="top:76%; left:27%; animation-delay:0.2s;">‚úß</span>
    </div>

    <!-- Header -->
    <header class="bts-header">
        <div class="header-container">
            <a href="index.html" class="header-logo">
                <img src="images/c267f3ce97e6dd79975da8d5128630d3fe89635fafdcb1d683e63faf6b4c71ee632313c7288461520d2559f298e089f5e0d25aa91c8704506e1bbd_1280.png" alt="BTS Logo" class="logo-img">
                <span class="logo-text">Bedtime Stories AI</span>
            </a>
            <nav class="header-nav">
                <a href="Home.html" class="nav-link active">Home</a>
                <a href="About.html" class="nav-link">About</a>
                <a href="Contact.html" class="nav-link">Contact</a>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="bts-main">
        <div class="main-container">

            <!-- Hero -->
            <div class="hero-title">
                <h1>üåô Magical Bedtime Stories</h1>
                <p>Create enchanting tales for your little ones, powered by Claude AI</p>
            </div>

            <!-- API Key Card -->
            <div class="card api-card">
                <div class="card-header">
                    <span class="card-icon">üîë</span>
                    <h3>Claude API Key</h3>
                </div>
                <div class="api-key-wrapper">
                    <input type="password" id="api-key-input" placeholder="sk-ant-api03-..." class="api-key-input" autocomplete="off">
                    <button onclick="toggleApiKeyVisibility()" class="btn-icon" title="Toggle visibility">üëÅ</button>
                    <button onclick="saveApiKey()" class="btn-save-key">Save</button>
                </div>
                <p class="api-hint">
                    Get your key at <a href="https://console.anthropic.com" target="_blank" rel="noopener">console.anthropic.com</a>
                    &nbsp;¬∑&nbsp; Stored only in your browser
                </p>
            </div>

            <!-- Story Workspace -->
            <div class="card story-card">
                <div class="card-header">
                    <span class="card-icon">üìñ</span>
                    <h3>Your Story</h3>
                </div>
                <textarea id="text-val" placeholder="Once upon a time, in a land far away..." rows="6"></textarea>
                <div id="result_json" class="story-result" style="display:none;"></div>
                <div class="story-actions">
                    <button onclick="appendStory()" class="btn-secondary" id="append-btn" style="display:none;">‚úö Add to Story</button>
                    <button onclick="saveDiv()" class="btn-secondary">üìÑ Save PDF</button>
                    <button onclick="printDiv()" class="btn-secondary">üñ® Print</button>
                </div>
            </div>

            <!-- Generate -->
            <div class="card genre-card">
                <div class="card-header">
                    <span class="card-icon">‚ú®</span>
                    <h3>Generate with Claude</h3>
                </div>
                <p class="genre-hint">Type a story beginning above, then pick a style:</p>
                <div class="genre-buttons">
                    <button onclick="callClaude('fairy')" class="genre-btn genre-fairy">
                        <span class="genre-icon">üßö‚Äç‚ôÄÔ∏è</span>
                        <span class="genre-name">Fairy Tales</span>
                        <span class="genre-desc">Magical &amp; enchanting</span>
                    </button>
                    <button onclick="callClaude('adventure')" class="genre-btn genre-adventure">
                        <span class="genre-icon">üë∫</span>
                        <span class="genre-name">Adventure</span>
                        <span class="genre-desc">Brave &amp; exciting</span>
                    </button>
                    <button onclick="callClaude('scifi')" class="genre-btn genre-scifi">
                        <span class="genre-icon">üëæ</span>
                        <span class="genre-name">Sci-Fi</span>
                        <span class="genre-desc">Cosmic &amp; curious</span>
                    </button>
                </div>
            </div>

            <!-- Controls -->
            <div class="card controls-card">
                <div class="controls-grid">
                    <div class="control-group">
                        <label class="control-label">
                            Length: <span class="control-value" id="length">40</span> words
                        </label>
                        <input type="range" min="20" max="100" value="40" step="10" class="modern-slider" id="RangeLength">
                        <div class="slider-labels"><span>Short</span><span>Long</span></div>
                    </div>
                    <div class="control-group">
                        <label class="control-label">
                            Creativity: <span class="control-value" id="temp">0.7</span>
                        </label>
                        <input type="range" min="0.0" max="1.0" value="0.7" step="0.1" class="modern-slider" id="RangeTemp">
                        <div class="slider-labels"><span>Steady</span><span>Wild</span></div>
                    </div>
                </div>
            </div>

            <!-- Voice Input -->
            <div class="card voice-card">
                <div class="card-header">
                    <span class="card-icon">üéôÔ∏è</span>
                    <h3>Voice Input</h3>
                </div>
                <p class="no-browser-support" style="display:none; color:#f87171; margin-bottom:10px;">
                    Voice recognition works in Chrome and Safari only.
                </p>
                <p id="recording-instructions" class="recording-status">
                    Press Start and allow microphone access to dictate your story.
                </p>
                <div class="voice-buttons">
                    <button id="start-record-btn" class="btn-voice btn-start">‚ñ∂ Start</button>
                    <button id="pause-record-btn" class="btn-voice btn-pause">‚è∏ Pause</button>
                    <button id="save-note-btn" class="btn-primary">üíæ Save Story</button>
                </div>
            </div>

            <!-- Saved Stories -->
            <div class="card stories-card">
                <div class="card-header">
                    <span class="card-icon">üìö</span>
                    <h3>My Stories</h3>
                </div>
                <ul id="notes" class="notes-list">
                    <li><p class="content no-notes">You don't have any stories yet.</p></li>
                </ul>
            </div>

        </div><!-- /.main-container -->
    </main>

    <!-- Loading Overlay -->
    <div id="loader" hidden class="loader-overlay">
        <div class="loader-content">
            <div class="loader-moon">üåô</div>
            <div class="loader-stars">
                <span>‚ú¶</span><span>‚ú¶</span><span>‚ú¶</span>
            </div>
            <p>Weaving your story...</p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bts-footer">
        <p>Michael Sullivan &nbsp;¬∑&nbsp; Lucas Crouch &nbsp;¬∑&nbsp; Clare Zhong &nbsp;¬∑&nbsp; Benjamin Martin</p>
        <p>Made with ‚ù§Ô∏è at Le Wagon &nbsp;¬∑&nbsp; Powered by <strong>Claude AI</strong> &nbsp;¬∑&nbsp; ¬© 2024</p>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="js/script.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.debug.js"
        integrity="sha384-NaWTHo/8YCBYJ59830LTz/P4aQZK1sS0SneOgAvhsIl3zBu8r9RevNg5lHCHAuQ/"
        crossorigin="anonymous"></script>

    <script>
        /* ==========================================
           Load saved API key on page load
           ========================================== */
        window.addEventListener('load', function () {
            var saved = localStorage.getItem('claude-api-key');
            if (saved) document.getElementById('api-key-input').value = saved;
        });

        /* ==========================================
           API Key helpers
           ========================================== */
        function getApiKey() {
            return document.getElementById('api-key-input').value.trim();
        }

        function saveApiKey() {
            var key = getApiKey();
            if (key) {
                localStorage.setItem('claude-api-key', key);
                showNotification('üîë API key saved!', 'success');
            } else {
                showNotification('Please enter an API key first.', 'error');
            }
        }

        function toggleApiKeyVisibility() {
            var input = document.getElementById('api-key-input');
            input.type = input.type === 'password' ? 'text' : 'password';
        }

        /* ==========================================
           Call Claude AI
           ========================================== */
        async function callClaude(genre) {
            var apiKey = getApiKey();
            if (!apiKey) {
                showNotification('Please enter your Claude API key first!', 'error');
                document.getElementById('api-key-input').focus();
                return;
            }

            var prompt  = document.getElementById('text-val').value.trim() || 'Once upon a time';
            var length  = document.getElementById('RangeLength').value;
            var temp    = parseFloat(document.getElementById('RangeTemp').value);

            var systemPrompts = {
                fairy: 'You are a magical bedtime storyteller for children. Continue the following fairy tale story in a warm, enchanting style suitable for children aged 4‚Äì10. Use gentle, whimsical language with vivid imagery. End at a natural, satisfying point. Write approximately ' + length + ' words.',
                adventure: 'You are a creative bedtime storyteller for children. Continue the following adventure story with brave heroes and exciting (but age-appropriate) moments. Keep it fun, positive, and comforting for bedtime. Write approximately ' + length + ' words and end at a natural point.',
                scifi: 'You are a creative bedtime storyteller for children. Continue the following science fiction story with wonder and curiosity about the cosmos, robots, or future worlds. Keep the tone uplifting and imaginative, suitable for children at bedtime. Write approximately ' + length + ' words.'
            };

            var loader    = document.getElementById('loader');
            var resultEl  = document.getElementById('result_json');
            var appendBtn = document.getElementById('append-btn');

            loader.removeAttribute('hidden');
            resultEl.style.display = 'none';
            resultEl.classList.remove('error');
            appendBtn.style.display = 'none';

            try {
                var response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': apiKey,
                        'anthropic-version': '2023-06-01',
                        'anthropic-dangerous-direct-browser-access': 'true'
                    },
                    body: JSON.stringify({
                        model: 'claude-haiku-4-5-20251001',
                        max_tokens: Math.max(500, parseInt(length) * 8),
                        temperature: temp,
                        system: systemPrompts[genre],
                        messages: [{ role: 'user', content: prompt }]
                    })
                });

                if (!response.ok) {
                    var errData = await response.json().catch(function () { return {}; });
                    throw new Error((errData.error && errData.error.message) || ('API error (' + response.status + ')'));
                }

                var data = await response.json();
                if (data.content && data.content[0] && data.content[0].text) {
                    resultEl.innerText = data.content[0].text;
                    resultEl.style.display = 'block';
                    appendBtn.style.display = 'inline-flex';
                    resultEl.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                } else {
                    throw new Error('Unexpected response from Claude.');
                }
            } catch (err) {
                resultEl.innerText = '‚ùå ' + err.message;
                resultEl.style.display = 'block';
                resultEl.classList.add('error');
            } finally {
                loader.setAttribute('hidden', '');
            }
        }

        /* ==========================================
           Append generated text to story textarea
           ========================================== */
        function appendStory() {
            var textarea  = document.getElementById('text-val');
            var result    = document.getElementById('result_json').innerText;
            if (result && result.charAt(0) !== '‚ùå') {
                if (textarea.value && textarea.value.slice(-1) !== ' ') {
                    textarea.value += ' ';
                }
                textarea.value += result;
                textarea.dispatchEvent(new Event('input'));
                document.getElementById('result_json').style.display = 'none';
                document.getElementById('append-btn').style.display  = 'none';
                textarea.scrollIntoView({ behavior: 'smooth' });
            }
        }

        /* ==========================================
           PDF & Print
           ========================================== */
        function saveDiv() {
            var text = document.getElementById('text-val').value;
            if (!text) { showNotification('Nothing to save yet!', 'error'); return; }
            var doc = new jsPDF();
            doc.setFontSize(16);
            doc.text('My Bedtime Story', 10, 15);
            doc.setFontSize(11);
            doc.text(text, 10, 28, { maxWidth: 185 });
            doc.save('bedtime-story.pdf');
        }

        function printDiv() {
            var text = document.getElementById('text-val').value;
            if (!text) { showNotification('Nothing to print yet!', 'error'); return; }
            var win = window.open('', 'PRINT', 'height=650,width=900,top=100,left=150');
            win.document.write('<head><title>Bedtime Story</title></head>');
            win.document.write('<body style="font-family:Georgia,serif;padding:48px;line-height:1.9;max-width:600px;margin:auto;color:#1e293b;">');
            win.document.write('<h1 style="color:#5b21b6;margin-bottom:24px;">üåô My Bedtime Story</h1>');
            win.document.write('<p>' + text.replace(/\n/g, '<br>') + '</p>');
            win.document.write('</body></html>');
            win.document.close();
            win.focus();
            win.print();
            win.close();
        }

        /* ==========================================
           Toast notifications
           ========================================== */
        function showNotification(message, type) {
            var notif = document.createElement('div');
            notif.className = 'notification notification-' + type;
            notif.textContent = message;
            document.body.appendChild(notif);
            requestAnimationFrame(function () { notif.classList.add('show'); });
            setTimeout(function () {
                notif.classList.remove('show');
                setTimeout(function () { notif.remove(); }, 300);
            }, 3000);
        }

        /* ==========================================
           Sliders
           ========================================== */
        (function () {
            var slidert = document.getElementById('RangeTemp');
            var outputt = document.getElementById('temp');
            outputt.innerHTML = slidert.value;
            slidert.oninput = function () { outputt.innerHTML = this.value; };

            var sliderl = document.getElementById('RangeLength');
            var outputl = document.getElementById('length');
            outputl.innerHTML = sliderl.value;
            sliderl.oninput = function () { outputl.innerHTML = this.value; };
        })();
    </script>
</body>
</html>
